import{l as h,aO as _,w as z,aP as E,aJ as M,aQ as y,ag as w,i as A,S as O,aR as R,aS as B,k as C,aT as P}from"./3bVjcIsQ.js";function I(e,t,o){let l;M(o)?l={evaluating:o}:l=o||{};const{lazy:f=!1,flush:i="pre",evaluating:a=void 0,shallow:s=!0,onError:n=y}=l,r=w(!f),u=s?w(t):A(t);let c=0;return O(async v=>{if(!r.value)return;c++;const g=c;let m=!1;a&&Promise.resolve().then(()=>{a.value=!0});try{const p=await e(S=>{v(()=>{a&&(a.value=!1),m||S()})});g===c&&(u.value=p)}catch(p){n(p)}finally{a&&g===c&&(a.value=!1),m=!0}},{flush:i}),f?h(()=>(r.value=!0,u.value)):u}const W=B?window:void 0;function b(e){var t;const o=_(e);return(t=o==null?void 0:o.$el)!=null?t:o}function x(){const e=w(!1),t=P();return t&&C(()=>{e.value=!0},t),e}function D(e){const t=x();return h(()=>(t.value,!!e()))}function J(e,t,o={}){const{window:l=W,...f}=o;let i;const a=D(()=>l&&"ResizeObserver"in l),s=()=>{i&&(i.disconnect(),i=void 0)},n=h(()=>{const c=_(e);return Array.isArray(c)?c.map(v=>b(v)):[b(c)]}),r=z(n,c=>{if(s(),a.value&&l){i=new ResizeObserver(t);for(const v of c)v&&i.observe(v,f)}},{immediate:!0,flush:"post"}),u=()=>{s(),r()};return E(u),{isSupported:a,stop:u}}const d=new Map;function Q(e){const t=R();function o(s){var n;const r=d.get(e)||new Set;r.add(s),d.set(e,r);const u=()=>f(s);return(n=t==null?void 0:t.cleanups)==null||n.push(u),u}function l(s){function n(...r){f(n),s(...r)}return o(n)}function f(s){const n=d.get(e);n&&(n.delete(s),n.size||i())}function i(){d.delete(e)}function a(s,n){var r;(r=d.get(e))==null||r.forEach(u=>u(s,n))}return{on:o,once:l,off:f,emit:a,reset:i}}export{J as a,b,I as c,Q as u};
